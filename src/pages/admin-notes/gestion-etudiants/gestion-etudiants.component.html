<!-- start side bar -->
<app-side-bar [isOpen] = "isOpen" [items] = "sidebarItems"></app-side-bar>
<!-- end sidebar -->

<!-- start min top nav -->
<app-nav-bar (toggle)="isOpen = !isOpen"></app-nav-bar>
<!-- end min top nav -->

<!-- start main -->
<main [ngClass]="{'md:ml-64 md:w-[calc(100%-256px)]': isOpen, 'md:ml-0': !isOpen}" class="bg-gray-100 duration-500 w-full h-svh pt-16 overflow-y-scroll">

    <!-- start account-creation-form -->
    <section class="p-4 mt-4">
        <div class="flex items-center justify-start gap-4 mt-3 mb-8">
            <i class="pi pi-users text-gray-500 shadow-lg rounded-lg text-3xl p-2 "></i>
            <h2 class="mb-2 text-3xl">gestion des etudiants</h2>
        </div>

        <div class="rounded-xl bg-white p-4 mt-4">
            <h2 class="mb-2 text-2xl">inscrire/rÃ©inscrire les etudiants</h2>
            <div class="rounded-xl p-4 h-fit grid grid-cols-1 gap-y-6">
                <div class="  p-4 rounded-lg  border border-gray-300 bg-white">
                    <h3 class="font-medium mb-4 text-black">choisir un fichier (.csv)</h3>
                    <div class="flex justify-start items-center gap-4 ">
                            <input (change)="onChange($event)" class="block w-1/3 p-2 text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-white focus:outline-none" type="file">
                            <p-button (onClick)="importer()" label="importer" icon="pi pi-upload" iconPos="right" size="small"></p-button>
                    </div>
                </div>
            </div>
        </div>

        <div class="rounded-xl bg-white p-4 mt-4">
            <h2 class="mb-2 text-2xl">gere les etudiants</h2>
            <div class="flex justify-between items-center mb-4">
                <select *ngFor="let niveau of niveaux"   class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-4/12 p-2.5" type="text">
                    <option [value]="niveau.id">{{niveau.alias}}</option>
                    <!-- <option *ngFor="let filiere of uniqueFilieres" [value]="filiere">{{filiere}}</option> -->
                </select>
                <input type="search" class="block w-1/3 p-2.5 text-sm border-gray-300 border rounded-lg focus:ring-blue-500 focus:border-blue-500" placeholder="rechercher">
            </div>
            <table class="w-full text-sm text-left rtl:text-right text-black shadow-md mt-2">
                <thead class="text-xs text-black uppercase bg-gray-200 shadow-md">
                    <tr>
                        <th scope="col" class="px-6 py-3">id</th>
                        <th scope="col" class="px-6 py-3">nom</th>
                        <th scope="col" class="px-6 py-3">prenom</th>
                        <th scope="col" class="px-6 py-3">cne</th>
                        <th scope="col" class="px-6 py-3">niveau</th>
                        <th scope="col" class="px-6 py-3">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let etudiant of etudiants" class="bg-white border-b">
                        <td class="px-6 py-4">{{etudiant.id}}</td>
                        <td class="px-6 py-4">{{etudiant.nom}}</td>
                        <td class="px-6 py-4">{{etudiant.prenom}}</td>
                        <td class="px-6 py-4">{{etudiant.cne}}</td>
                        <td class="px-6 py-4">{{etudiant.niveau.intitule}}</td>
                        <td class="px-6 py-4">
                            <p-button (onClick)="showDialogEdit(etudiant)" icon="pi pi-pencil" [rounded]="true" [raised]="true"  severity="info" class="mx-3"></p-button>
                            <p-button (onClick)="deleteEtudiant(etudiant.id)"  icon="pi pi-trash" [rounded]="true" [raised]="true"  severity="danger"></p-button>
                        </td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="flex justify-start items-center gap-4 ">
            <p-button label="exporter cette list" icon="pi pi-file-export" iconPos="right" size="small"></p-button>
        </div>
    </section>
    <!-- end account-creation-form -->

<!-- edit filiere -->
<p-dialog header="modifier" class="text-center" [modal]="true" [(visible)]="visible_edit" [style]="{width: '30rem'}" [draggable]="false" [resizable]="false" [breakpoints]="{ '960px': '75vw' }">
    <!-- edit form -->
    <div class="flex justify-center text-left ">
        <form [formGroup]="fg" class="w-full" (ngSubmit)="edit($event)">
                <div class = "grid grid-cols-1 sm:grid-cols-2 gap-5 mt-5 w-full">

                    <!-- nom -->
                    <div>
                        <label class="block mb-2 text-sm font-medium" for="">nom</label>
                        <input type="text" formControlName = "nom"   class="block w-full p-2.5 text-sm border-gray-300 border rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- prenom -->
                    <div>
                        <label class="block mb-2 text-sm font-medium" for="">prenom</label>
                        <input type="text" formControlName = "prenom"  class="block w-full p-2.5 text-sm border-gray-300 border rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- cne -->
                    <div>
                        <label class="block mb-2 text-sm font-medium" for="">cne</label>
                        <input type="text" formControlName = "cne" class="block w-full p-2.5 text-sm border-gray-300 border rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    </div>

                </div>
                <button type="submit" class="w-full mt-5 rounded-md bg-slate-600 text-center py-3 text-white" >modifier</button>
        </form>
    </div>

   </p-dialog>
   <p-toast />
    <p-confirmdialog />
</main>
<!-- end main -->
